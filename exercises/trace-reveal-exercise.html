<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1,viewport-fit=cover" />
  <title>Trace & Reveal â€” Simple</title>
  <style>
    body { background:#0b1024; color:#fff; font-family:sans-serif; margin:0; }
    header { padding:10px 16px; background:#111a33; }
    header h1 { margin:0; font-size:18px; }
    .grid { display:grid; grid-template-columns:300px 1fr; gap:16px; padding:16px; }
    @media(max-width:800px){ .grid{grid-template-columns:1fr;} }
    .panel { background:#1a2347; border-radius:10px; padding:16px; }
    .btn { background:#2b406f; color:#fff; border:none; padding:8px 14px; border-radius:8px; cursor:pointer; }
    .pill { border-radius:999px; padding:6px 10px; border:1px solid #3b4c7f; background:#223; color:#fff; cursor:pointer; }
    .pill[aria-pressed="true"]{ background:#4c6fcf; }
    .hud { display:flex; justify-content:space-between; margin-bottom:8px; flex-wrap:wrap; gap:6px; }
    .chip{ background:#223; padding:4px 8px; border-radius:999px; font-size:12px; }
    canvas { width:100%; height:100%; border-radius:10px; background:#000; }
  </style>
</head>
<body>
  <header><h1>Trace & Reveal</h1></header>
  <main class="grid">
    <section class="panel">
      <h2>Settings</h2>
      <p>Session length:</p>
      <div>
        <button class="pill" data-length="30" aria-pressed="false">30 sec</button>
        <button class="pill" data-length="60" aria-pressed="true">60 sec</button>
        <button class="pill" data-length="90" aria-pressed="false">90 sec</button>
      </div>
      <p>Brush size:</p>
      <input id="brush" type="range" min="6" max="40" step="2" value="18" />
      <div style="margin-top:10px;">
        <button id="startBtn" class="btn">Start</button>
      </div>
      <div>PB: <b id="pbValue">0</b></div>
    </section>
    <section class="panel">
      <div class="hud">
        <div><span class="chip">Score <b id="score">0</b></span>
        <span class="chip">PB <b id="pb">0</b></span>
        <span class="chip">Coverage <b id="coverage">0%</b></span></div>
        <div><span class="chip">Time <b id="timeChip">00:00</b></span>
        <button id="pauseBtn" class="btn">Pause</button>
        <button id="exitBtn" class="btn">Exit</button></div>
      </div>
      <div style="aspect-ratio:1/1; max-width:500px; margin:auto;">
        <canvas id="guideCanvas"></canvas>
      </div>
    </section>
  </main>
  <script>
    const pills=[...document.querySelectorAll('.pill[data-length]')]; let chosenLen=60;
    function selectLength(sec){ chosenLen=sec; pills.forEach(p=>p.setAttribute('aria-pressed',String(p.dataset.length==sec)));}
    pills.forEach(p=>p.addEventListener('click',()=>selectLength(Number(p.dataset.length)))); selectLength(60);
    const $=id=>document.getElementById(id); const timeChip=$('timeChip'); const scoreEl=$('score'); const pbEl=$('pb'); const pbValueEl=$('pbValue'); const coverageEl=$('coverage');
    let playing=false,paused=false,startTs=0,totalMs=60000,remainingMs=0,rafId=0; let score=0,bestCoverage=0,personalBest=0;
    function fmtTime(ms){const s=Math.ceil(ms/1000);return String(Math.floor(s/60)).padStart(2,'0')+':'+String(s%60).padStart(2,'0');}
    function startSession(){ if(playing)return; score=0;scoreEl.textContent='0'; bestCoverage=0;coverageEl.textContent='0%'; totalMs=chosenLen*1000;remainingMs=totalMs;startTs=performance.now();playing=true; loop(); drawShapes();}
    function loop(ts){ if(!playing){cancelAnimationFrame(rafId);return;} rafId=requestAnimationFrame(loop); if(paused)return; const now=performance.now();const elapsed=now-startTs;remainingMs=Math.max(0,totalMs-elapsed);timeChip.textContent=fmtTime(remainingMs); if(remainingMs<=0){endSession();}}
    function pauseSession(){ if(!playing)return; paused=!paused; if(!paused){startTs=performance.now()-(totalMs-remainingMs);}}
    function endSession(){playing=false;cancelAnimationFrame(rafId); if(score>personalBest){personalBest=score;pbEl.textContent=score;pbValueEl.textContent=score;}}
    $('startBtn').onclick=startSession; $('pauseBtn').onclick=pauseSession; $('exitBtn').onclick=endSession;
    // draw simple shapes
    const guide=$('guideCanvas'); const ctx=guide.getContext('2d'); function resize(){guide.width=guide.clientWidth*devicePixelRatio;guide.height=guide.clientHeight*devicePixelRatio;drawShapes();} window.addEventListener('resize',resize);
    function drawShapes(){ctx.clearRect(0,0,guide.width,guide.height);ctx.strokeStyle='#fff';ctx.lineWidth=3;const w=guide.width,h=guide.height;
      ctx.strokeRect(w*0.2,h*0.2,w*0.2,h*0.2);ctx.beginPath();ctx.arc(w*0.7,h*0.3,w*0.1,0,Math.PI*2);ctx.stroke();
      ctx.beginPath();ctx.moveTo(w*0.5,h*0.7);ctx.lineTo(w*0.4,h*0.9);ctx.lineTo(w*0.6,h*0.9);ctx.closePath();ctx.stroke();
    }
    resize();
  </script>
</body>
</html>